"use strict";(globalThis.webpackChunkaws_ps_tech_docs=globalThis.webpackChunkaws_ps_tech_docs||[]).push([[2429],{270(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/mCzscreenshot-2024-07-08-at-12-22-18-pm-5c292c1eec5ae500dadf8a68ad2bc49e.png"},364(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/KxIscreenshot-2024-06-24-at-9-31-12-am-173e9141fc917a4b961fe9cb319dc281.png"},612(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/8BOuntitled-26-c977fe380ce850e3c3ce5a7ced4d571f.png"},820(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/Y8muntitled-7-364c0c2f085ac2ed6181731df28e8cd1.png"},955(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/uaCimage-635dd5cb16fc29931595675d18286f60.png"},1318(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/6rnimage-afe45ccc586b64cf8fe82583e29ff328.png"},1383(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/CrLimage-56db00bba0bf8c46bfcc47fa76a1dfcf.png"},1499(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/jHsuntitled-21-1333be95c8cfbeed6ccfcc4f1829d99b.png"},1528(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/I3Cscreenshot-2024-06-24-at-9-31-00-am-770c9395c7b75b5beead5791378e4c2b.png"},1774(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/untitled-30-7c6c5df8b3fcb3eb4550a0620839802b.png"},1788(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/qjKimage-25f91bfa90c0135337f0cba0c3514b6b.png"},2028(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/QUfuntitled-29-602a48c4c71b3afad6a3ae6dd56dbed2.png"},2233(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/SZ9untitled-6-7b435fcafefb33a1fa79c446a7054e87.png"},2246(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/nz9screenshot-2024-07-08-at-11-47-56-am-097bccd255d4116011cc4499d51ec03c.png"},2386(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/rYGimage-01dad16acbd2de35705bf1bb52e26603.png"},2959(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/Yhguntitled-2-03fc2f4617f9c65ff68b17554e5e30e9.png"},3045(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/G4vscreenshot-2024-06-24-at-3-26-55-pm-c3080dc22ff83bf817d2d7b95af49eab.png"},3086(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/jY3image-1124181072c8a5d0b747fa2ef24363bd.png"},3313(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/p2Eimage-39d76712f2c6aa95965fa2cfe0b3db06.png"},3587(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/zwjimage-6f7d6e416472fff009a7043ebde2eb72.png"},3775(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/MLountitled-19-f070ff3f2eb65d77906b76936bec3bf4.png"},4875(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/ubMuntitled-20-5635f1c64b71e357452d339aa67e0f68.png"},5022(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/Ro2untitled-24-7a74429d7788cac2cdf11fdf10e7b65b.png"},5072(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"omics-on-aws/quickstart-hail-english","title":"Quickstart Hail (English)","description":"Deploy an\xa0EMR cluster on AWS, with Spark, Hail, Zeppelin and Ensembl VEP using CloudFormation service.","source":"@site/docs/omics-on-aws/quickstart-hail-english.md","sourceDirName":"omics-on-aws","slug":"/omics-on-aws/quickstart-hail-english","permalink":"/docusaurus/en/omics-on-aws/quickstart-hail-english","draft":false,"unlisted":false,"editUrl":"https://github.com/aws-wwps-kr-tech/docusaurus/tree/main/docs/omics-on-aws/quickstart-hail-english.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Quickstart Hail (English)","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Quickstart Hail (Korean)","permalink":"/docusaurus/en/omics-on-aws/quickstart-hail-korean"},"next":{"title":"\uba87 \uac00\uc9c0 \uae30\ub2a5\uacfc \uc54c\uc544\ub458 \uac83\ub4e4","permalink":"/docusaurus/en/omics-on-aws/a597e"}}');var i=s(4848),a=s(8453);const c={title:"Quickstart Hail (English)",sidebar_position:4},r="",l={},d=[{value:"Pre-downloading VEP Data and Storing in Bucket",id:"pre-downloading-vep-data-and-storing-in-bucket",level:2},{value:"AMI Build",id:"ami-build",level:2},{value:"<strong>RODA_BUCKET</strong>                     *<em>value for the <code>BucketHail</code> key in CloudFormation Outputs*</em>",id:"roda_bucket---------------------value-for-the-buckethail-key-in-cloudformation-outputs",level:2},{value:"EMR Cluster Setup",id:"emr-cluster-setup",level:2},{value:"SageMaker Notebook Setup",id:"sagemaker-notebook-setup",level:2},{value:"numpy reinstall",id:"numpy-reinstall",level:2},{value:"VEP configuration",id:"vep-configuration",level:2},{value:"VEP Plugin Installation",id:"vep-plugin-installation",level:2},{value:"Dynamically Expanding EMR Cluster EBS (HDFS) Volume",id:"dynamically-expanding-emr-cluster-ebs-hdfs-volume",level:2},{value:"FAQ",id:"faq",level:2},{value:"Codebuild",id:"codebuild",level:3}];function o(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:""})}),"\n",(0,i.jsxs)(n.p,{children:["Deploy an\xa0",(0,i.jsx)(n.a,{href:"https://aws.amazon.com/emr/",children:"EMR cluster on AWS"}),", with Spark, ",(0,i.jsx)(n.a,{href:"https://hail.is/index.html",children:"Hail"}),", ",(0,i.jsx)(n.a,{href:"https://zeppelin.apache.org/",children:"Zeppelin"})," and ",(0,i.jsx)(n.a,{href:"https://ensembl.org/info/docs/tools/vep/index.html",children:"Ensembl VEP"})," using CloudFormation service."]}),"\n",(0,i.jsx)(n.p,{children:"This tool requires the following programs to be previously installed in your computer:\\"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Amazon's ",(0,i.jsx)(n.code,{children:"Command Line Interface (CLI)"})," utility"]}),"\n",(0,i.jsx)(n.li,{children:"Git"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"To install the required software open a terminal and execute the following:"}),"\n",(0,i.jsx)(n.p,{children:"For Mac:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'# Installs homebrew\nruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"\n\n# Installs AWS CLI\nbrew install awscli\n'})}),"\n",(0,i.jsx)(n.p,{children:"For Debian / Ubuntu (apt-get):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"\nunzip awscliv2.zip\nsudo ./aws/install\n\nsudo apt-get install -y git\n'})}),"\n",(0,i.jsx)(n.p,{children:"For Fedora (dnf/yum):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"\nunzip awscliv2.zip\nsudo ./aws/install\n\nsudo dnf install git # or sudo yum install git\n'})}),"\n",(0,i.jsx)(n.p,{children:"For Amazon Linux 2023:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo dnf install git\n"})}),"\n",(0,i.jsx)(n.h1,{id:"cloudformation-stack-preparation",children:"CloudFormation stack preparation"}),"\n",(0,i.jsx)(n.p,{children:"1. Prepare the AWS credentials and apply them in the terminal.\xa0\\"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Export AWS_DEFAULT_REGION=""\nExport AWS_ACCESS_KEY_ID=""\nExport AWS_SECRET_ACCESS_KEY=""\nExport AWS_SESSION_TOKEN=""\n'})}),"\n",(0,i.jsx)(n.p,{children:"2. Create an S3 bucket in the region where you want to launch this CloudFormation stack."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"aws s3 mb s3:// --region \n"})}),"\n",(0,i.jsx)(n.p,{children:"Download and unzip the content from this repository, then place the downloaded content into the S3 bucket you created earlier."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Export AWS_BUCKET=\ngit clone https://github.com/hmkim/quickstart-hail.git\ncd quickstart-hail\naws s3 sync . s3://$AWS_BUCKET/quickstart-hail/ --exclude ".git/*"\n'})}),"\n",(0,i.jsx)(n.p,{children:"3. Connect to the Amazon S3 console and check the bucket and directory."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(955).A+"",width:"2436",height:"1842"})}),"\n",(0,i.jsx)(n.p,{children:"\\"}),"\n",(0,i.jsx)(n.h1,{id:"run-the-cloudformation-stack",children:"Run the CloudFormation stack"}),"\n",(0,i.jsxs)(n.p,{children:["1. Go to the ",(0,i.jsx)(n.a,{href:"https://us-east-1.console.aws.amazon.com/cloudformation/home?region=us-east-1",children:"CloudFormation"})," console.\\"]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(9965).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsxs)(n.p,{children:["2. Creates a new stack. At this time, select ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"With new resources (standard)"})}),".\\"]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(6630).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsxs)(n.p,{children:["3. Go to the Amazon S3 console, select ",(0,i.jsx)(n.code,{children:"hail-launcher.template.yaml"})," in the template directory you uploaded earlier, and click ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"Copy URL"})}),". The path is as follows:"]}),"\n",(0,i.jsx)(n.p,{children:"** > quickstart-hail > templates > hail-launcher.template.yaml**"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(5636).A+"",width:"2406",height:"314"})}),"\n",(0,i.jsx)(n.p,{children:"When creating a CloudFormation stack, enter this URL and create the stack."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(8097).A+"",width:"2300",height:"1080"})}),"\n",(0,i.jsx)(n.p,{children:"4. Proceed with entering information to create a stack.\\"}),"\n",(0,i.jsx)(n.p,{children:"Type an name for the stack."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(8462).A+"",width:"1176",height:"296"})}),"\n",(0,i.jsx)(n.p,{children:"Select a VPC. Select one subnet within the same VPC. For this exercise, select public."}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(2959).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"Let's set it up to create additional buckets as needed."}),"\n",(0,i.jsxs)(n.p,{children:["Enter the name of the existing bucket where the ",(0,i.jsx)(n.code,{children:"quickstart-hail"})," folder was uploaded, and check the region."]}),"\n",(0,i.jsxs)(n.p,{children:["Here, the bucket name ",(0,i.jsx)(n.code,{children:"awsimd-us-east-1"})," was used, and the ",(0,i.jsx)(n.code,{children:"Hail S3 bucket name"})," and ",(0,i.jsx)(n.code,{children:"Sagemaker home directory S3 bucket name"})," were suffixed with ",(0,i.jsx)(n.code,{children:"-s3"})," and ",(0,i.jsx)(n.code,{children:"-sm"}),", respectively. Modify the bucket names as appropriate.\\"]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(8635).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(8883).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsxs)(n.p,{children:["5. Finally, press the ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"Next"})})," button to create the stack."]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(9607).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(2233).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"6. Check stack creation in CloudFormation."}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(820).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsxs)(n.p,{children:["If the following portfolio appears in the output along with the ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"CREATE_COMPLETE"})})," message in the top stack, you can confirm that it was executed correctly."]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(7899).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.h1,{id:"create-an-ami-for-hail-and-vep",children:"Create an AMI for Hail and VEP"}),"\n",(0,i.jsx)(n.h2,{id:"pre-downloading-vep-data-and-storing-in-bucket",children:"Pre-downloading VEP Data and Storing in Bucket"}),"\n",(0,i.jsxs)(n.p,{children:["For VEP, you can pre-download the data and store it in the bucket created or specified through the stack (using the ",(0,i.jsx)(n.code,{children:"bucketHail"})," value from CloudFormation's Outputs).\\"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(3086).A+"",width:"2484",height:"882"})}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(8098).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"Download VEP data using the wget command:\\"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"wget ftp://ftp.ensembl.org/pub/release-112/variation/vep/homo_sapiens_vep_112_GRCh37.tar.gz\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Upload the downloaded file to your bucket: ([I emphasize that this is the value for the ",(0,i.jsx)(n.code,{children:"BucketHail"})," key confirmed in CloudFormation Outputs])\\"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"aws s3 cp homo_sapiens_vep_112_GRCh37.tar.gz s3:///vep/cache/\n"})}),"\n",(0,i.jsx)(n.h2,{id:"ami-build",children:"AMI Build"}),"\n",(0,i.jsxs)(n.p,{children:["1. Access the ",(0,i.jsx)(n.a,{href:"https://us-east-1.console.aws.amazon.com/codesuite/codebuild/projects?region=us-east-1",children:"CodeBuild console"})," and initiate the build process for each new AMI. Select Start build > Start with overrides."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(8461).A+"",width:"1366",height:"346"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(3587).A+"",width:"3132",height:"530"})}),"\n",(0,i.jsx)(n.p,{children:"2. In the Environment section, expand Additional configuration and input the required values.\\"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(9703).A+"",width:"1198",height:"960"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(1318).A+"",width:"1252",height:"1250"})}),"\n",(0,i.jsx)(n.p,{children:"HAIL_VERSION       0.2.105"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"HTSLIB_VERSION     1.20\nSAMTOOLS_VERSION   1.20"}),"\n",(0,i.jsx)(n.p,{children:"* For building with hail-vep option (includes VEP installation):\\"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"HAIL_VERSION                        0.2.105"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"HTSLIB_VERSION                      1.20"}),"\n",(0,i.jsx)(n.p,{children:"SAMTOOLS_VERSION                    1.20"}),"\n",(0,i.jsx)(n.p,{children:"VEP_VERSION                         107"}),"\n",(0,i.jsxs)(n.h2,{id:"roda_bucket---------------------value-for-the-buckethail-key-in-cloudformation-outputs",children:[(0,i.jsx)(n.strong,{children:"RODA_BUCKET"}),"                     *",(0,i.jsxs)(n.em,{children:["value for the ",(0,i.jsx)(n.code,{children:"BucketHail"})," key in CloudFormation Outputs*"]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(2386).A+"",width:"1122",height:"906"})}),"\n",(0,i.jsx)(n.p,{children:"3. Check the build status in CodeBuild\\"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Hail (without VEP):"})," The Hail image build completes in about 20 minutes."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(8596).A+"",width:"2888",height:"1796"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(5313).A+"",width:"2838",height:"972"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Hail (VEP)"}),": The VEP version build takes approximately 1 hour and 38 minutes to complete.\\"]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(1528).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(364).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsxs)(n.p,{children:["You can find the **AMI results** in either the AMI menu of ",(0,i.jsx)(n.a,{href:"https://console.aws.amazon.com/ec2/",children:"Amazon EC2 console"})," or CodeBuild logs."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(6222).A+"",width:"1680",height:"323"})}),"\n",(0,i.jsx)(n.h1,{id:"emr-cluster-setup-and-jupyter-environment-configuration",children:(0,i.jsx)(n.strong,{children:"EMR Cluster Setup and Jupyter Environment Configuration"})}),"\n",(0,i.jsx)(n.h2,{id:"emr-cluster-setup",children:"EMR Cluster Setup"}),"\n",(0,i.jsx)(n.p,{children:"1. In the CloudFormation service console's Outputs tab, click the portfolio."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(6853).A+"",width:"2484",height:"882"})}),"\n",(0,i.jsx)(n.p,{children:"2. In the portfolio of AWS Service Catalog, locate the relevant Product, click the Access tab, then select Grant access.\\"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(1788).A+"",width:"2994",height:"1326"})}),"\n",(0,i.jsx)(n.p,{children:"3. Add permissions.\xa0Check the user that suits you and grant them access to Hail Products. Search for it, select it, and click Grant access.\\"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(8355).A+"",width:"512",height:"248"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(5705).A+"",width:"2306",height:"1024"})}),"\n",(0,i.jsx)(n.p,{children:"4. After confirming access permissions, navigate to the Product in the Provisioning menu.\\"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(6003).A+"",width:"2292",height:"1122"})}),"\n",(0,i.jsx)(n.p,{children:"5. With permissions granted, you should now see 2 Products listed.\\"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(5104).A+"",width:"2998",height:"446"})}),"\n",(0,i.jsx)(n.p,{children:"6. Select the Hail EMR Cluster product and click Launch product.\\"}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(3775).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"7. Enter the required launch information.\\"}),"\n",(0,i.jsx)(n.p,{children:"Either enter a name manually or click Generate name.\\"}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(4875).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"Specify the Hail AMI you created earlier. You can find the AMI ID in the EC2 service's AMIs section (as previously described).\\"}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(1499).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"Input the Cluster name and Hail AMI ID. You can leave all other settings at their default values.\\"}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(8550).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"8. Click Launch product at the bottom of the page.\\"}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(2246).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.h2,{id:"sagemaker-notebook-setup",children:"SageMaker Notebook Setup"}),"\n",(0,i.jsx)(n.p,{children:"1. Similarly, select Launch product in the Product menu.\\"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(3313).A+"",width:"2292",height:"428"})}),"\n",(0,i.jsx)(n.p,{children:"2. Provide a name for your Hail notebook instance. Keep all other settings at their defaults.\\"}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(5022).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"3. Click Launch product at the bottom of the page.\\"}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(8376).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"**Note: You can monitor the product deployment progress through CloudFormation.*"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(1383).A+"",width:"972",height:"734"})}),"\n",(0,i.jsx)(n.h2,{id:"numpy-reinstall",children:"numpy reinstall"}),"\n",(0,i.jsxs)(n.p,{children:["The issue occurs when running as it is currently. ",(0,i.jsx)(n.strong,{children:"As of Mar 14, 2025"})]}),"\n",(0,i.jsx)(n.p,{children:"Therefore, it is necessary to check the cluster created by Amazon EMR as shown below, connect to the Primary instance, delete and reinstall the numpy module."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(5636).A+"",width:"2406",height:"314"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(9793).A+"",width:"2448",height:"754"}),(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(9984).A+"",width:"2574",height:"466"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\uc774\ubbf8\uc9c0",src:s(9461).A+"",width:"2592",height:"550"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo python3 -m pip uninstall -y numpy\n\nsudo python3 -m pip install  numpy -U\n"})}),"\n",(0,i.jsx)(n.p,{children:"\\"}),"\n",(0,i.jsx)(n.h1,{id:"gwas-practice-using-hail",children:"GWAS Practice using Hail"}),"\n",(0,i.jsx)(n.p,{children:"1. Launch your notebook. Find the URL in CloudFormation's Outputs tab. Clicking it will automatically connect you to your notebook instance in Amazon SageMaker.\\"}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(612).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"2. Select Open JupyterLab to start the notebook interface.\\"}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(5371).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"3. We'll work with two notebooks in this practice session:\\"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"common-notebooks/plotting-tutorail.ipynb"}),"\n",(0,i.jsx)(n.li,{children:"common-notebooks/GWAS-tutorial.ipynb"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(3045).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"Locate your previously created EMR cluster and update the Cluster Name in the second cell."}),"\n",(0,i.jsx)(n.p,{children:"You can execute notebook cells in sequence by placing your cursor in the cell where you want to begin."}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(8234).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"When the tutorial code runs successfully, you should see results similar to these:"}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(9459).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(2028).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(270).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.h1,{id:"additional-information",children:"Additional Information"}),"\n",(0,i.jsx)(n.h2,{id:"vep-configuration",children:"VEP configuration"}),"\n",(0,i.jsx)(n.p,{children:"In the S3 bucket, select the json file object and click Copy S3 URI.\\"}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(1774).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.p,{children:"Ex: vep-configuration-GRCh37.json\\"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:',\n    "vep_json_schema": "Struct],context:String,end:Int32,id:String,input:String,intergenic_consequences:Array[Struct],most_severe_consequence:String,motif_feature_consequences:Array[Struct],regulatory_feature_consequences:Array[Struct],seq_region_name:String,start:Int32,strand:Int32,transcript_consequences:Array[Struct],exon:String,gene_id:String,gene_pheno:Int32,gene_symbol:String,gene_symbol_source:String,hgnc_id:String,hgvsc:String,hgvsp:String,hgvs_offset:Int32,impact:String,intron:String,lof:String,lof_flags:String,lof_filter:String,lof_info:String,minimised:Int32,polyphen_prediction:String,polyphen_score:Float64,protein_end:Int32,protein_start:Int32,protein_id:String,sift_prediction:String,sift_score:Float64,strand:Int32,swissprot:String,transcript_id:String,trembl:String,tsl:Int32,uniparc:String,variant_allele:String}],variant_class:String}"\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["You can modify and implement the following content in the ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://github.com/hmkim/quickstart-hail/blob/main/sagemaker/common-notebooks/vep-tutorial.ipynb",children:"vep-tutorial"})})," code using the S3 object URI you copied above."]}),"\n",(0,i.jsxs)(n.p,{children:["!",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(7230).A+"",children:"\uc774\ubbf8\uc9c0"})]}),"\n",(0,i.jsx)(n.h2,{id:"vep-plugin-installation",children:"VEP Plugin Installation"}),"\n",(0,i.jsxs)(n.p,{children:["If you need to modify VEP plugin installations (additions, etc.), you'll need to rebuild the AMI. The VEP installation code is in ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://github.com/hmkim/quickstart-hail/blob/main/packer-files/scripts/vep_install.sh",children:"vep_install.sh"})}),". Modify this script and rebuild the AMI as needed."]}),"\n",(0,i.jsx)(n.p,{children:"For customizing Hail, VEP tool installation, and AMI building, refer to these resources:"}),"\n",(0,i.jsx)(n.h2,{id:"-1"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/hmkim/quickstart-hail/blob/main/docs/hail-ami.md",children:"Hail AMI Creation via AWS CodeBuild"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/hmkim/quickstart-hail/blob/main/docs/vep-install.md",children:"vep-install.md"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/hmkim/quickstart-hail/blob/main/docs/ami-creation.md",children:"Building a Custom Hail AMI"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"dynamically-expanding-emr-cluster-ebs-hdfs-volume",children:"Dynamically Expanding EMR Cluster EBS (HDFS) Volume"}),"\n",(0,i.jsx)(n.p,{children:"When working with large datasets, you may find the initially configured cluster volume capacity insufficient. You can dynamically expand the EBS volume by following the guidance in this blog post:\\"}),"\n",(0,i.jsx)(n.p,{children:"[[]]"}),"\n",(0,i.jsx)(n.h2,{id:"faq",children:"FAQ"}),"\n",(0,i.jsx)(n.h3,{id:"codebuild",children:"Codebuild"}),"\n",(0,i.jsxs)(n.p,{children:['CLIENT_ERROR: error while downloading key ami/packer-files.zip, error: RequestError: send request failed caused by: Get "',(0,i.jsx)(n.a,{href:"https://.s3.amazonaws.com/ami/packer-files.zip",children:"https://.s3.amazonaws.com/ami/packer-files.zip"}),'":'," dial tcp 3.5.30.46:443: i/o timeout for primary source\\"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},5104(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/ZYiimage-fdaab6be191f1721c3357a3a40eabf7c.png"},5313(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/VdYimage-58f128c28f6b2d250e2e3e842b335449.png"},5371(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/XaHuntitled-27-a0e59b35b8d8fd94de4dfbe40bf04d81.png"},5636(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/image-3e85724a564dc17aa0100397b901dbbf.png"},5705(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/0lWimage-a6cee6843ed6759bd7cd2d5e3c5799dd.png"},6003(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/UvRimage-5ec73f1572ad249b027b8a3c330a1c9f.png"},6222(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/IgJimage-849699757ee27f8c3d69fc1ca2320ced.png"},6630(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/M7Hscreenshot-2024-06-21-at-10-27-22-pm-bccdde7279bd919b59a49889ffda1a40.png"},6853(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/9emimage-ff51a41fa28e0e5e2c846931d08df052.png"},7230(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/screenshot-2024-07-11-at-11-07-00-am-e7e76e03fd3409664688b963615a791e.png"},7899(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/ejCuntitled-8-70ce54897ae3471754926f45457062ff.png"},8097(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/Whlimage-3f5aae3a444d2a3c368eb7b12c968b6d.png"},8098(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/eELuntitled-10-edd42fe5f1b8804f1dae9169abaf6614.png"},8234(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/S5uuntitled-28-aa2ccdf3c3ddb873c89f6516b9a728b3.png"},8355(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/A2zimage-0daa8ff063642217050280bdf272ae55.png"},8376(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/PcJscreenshot-2024-07-08-at-11-47-56-am-097bccd255d4116011cc4499d51ec03c.png"},8453(e,n,s){s.d(n,{R:()=>c,x:()=>r});var t=s(6540);const i={},a=t.createContext(i);function c(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(a.Provider,{value:n},e.children)}},8461(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/t6qimage-6d5a0a3585ebf7f31e7b08fa5c472ded.png"},8462(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/JI3image-17a84de9d36dd66151bca273caaa8154.png"},8550(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/sEGuntitled-22-8acf391fee5c8e3eb257a6876dea605e.png"},8596(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/9Wlimage-dd27806d8578a7ef5db6ff52b3ef0252.png"},8635(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/kRNuntitled-3-f78219a45f81208f8f57ab2615847b7c.png"},8883(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/Gn9untitled-4-c20afd5d3b876542e5719d25043029bb.png"},9459(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/Eevscreenshot-2024-07-08-at-12-21-50-pm-0c20c4dc57918db3fdca00fab56e81c4.png"},9461(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/opximage-b8638861172c1d98ccc9dd3c43ad6670.png"},9607(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/el0untitled-5-e919dd82dd52e143754aa5ebfe21e015.png"},9703(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/Nz5image-2590aa250297cfaf68e7b837db2d8393.png"},9793(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/sxXimage-421526b95d982f71f65e1bfd1f164d68.png"},9965(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/files/wADscreenshot-2024-06-21-at-10-26-55-pm-623d12d74c64d1b860643c8f0e457a9c.png"},9984(e,n,s){s.d(n,{A:()=>t});const t=s.p+"assets/images/xd0image-d684aef0df275a4a8a8523a1730a9317.png"}}]);