"use strict";(globalThis.webpackChunkaws_ps_tech_docs=globalThis.webpackChunkaws_ps_tech_docs||[]).push([[2805],{2691(e,s,n){n.r(s),n.d(s,{assets:()=>i,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"omics-on-aws/nf-core-rnaseq","title":"Nf-core \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud558\uae30 (rnaseq)","description":"\ucc38\uace0 \ubb38\uc11c//catalog.us-east-1.prod.workshops.aws/workshops/76d4a4ff-fe6f-436a-a1c2-f7ce44bc5d17/en-US","source":"@site/docs/omics-on-aws/nf-core-rnaseq.md","sourceDirName":"omics-on-aws","slug":"/omics-on-aws/nf-core-rnaseq","permalink":"/docusaurus/omics-on-aws/nf-core-rnaseq","draft":false,"unlisted":false,"editUrl":"https://github.com/aws-wwps-kr-tech/docusaurus/tree/main/docs/omics-on-aws/nf-core-rnaseq.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Nf-core \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud558\uae30 (rnaseq)","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Nf-core \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud558\uae30 (scrnaseq)","permalink":"/docusaurus/omics-on-aws/nf-core-scrnaseq"},"next":{"title":"Nf-core \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud558\uae30 (spatialvi)","permalink":"/docusaurus/omics-on-aws/nf-core-spatialvi"}}');var t=n(4848),o=n(8453);const a={title:"Nf-core \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud558\uae30 (rnaseq)",sidebar_position:2},c=void 0,i={},l=[{value:"\ud504\ub85c\uc81d\ud2b8 \uc14b\uc5c5",id:"\ud504\ub85c\uc81d\ud2b8-\uc14b\uc5c5",level:2},{value:"nf-core repository\ub85c\ubd80\ud130 \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ubcf5\uc81c",id:"nf-core-repository\ub85c\ubd80\ud130-\uc6cc\ud06c\ud50c\ub85c\uc6b0-\ubcf5\uc81c",level:4},{value:"Docker Image Manifest\uc758 \uc0dd\uc131",id:"docker-image-manifest\uc758-\uc0dd\uc131",level:4},{value:"\ucee8\ud14c\uc774\ub108 \uc0ac\uc124\ud654",id:"\ucee8\ud14c\uc774\ub108-\uc0ac\uc124\ud654",level:4},{value:"nf-core project \ucf54\ub4dc \uc5c5\ub370\uc774\ud2b8",id:"nf-core-project-\ucf54\ub4dc-\uc5c5\ub370\uc774\ud2b8",level:4},{value:"AWS HealthOmics \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ub9cc\ub4e4\uae30",id:"aws-healthomics-\uc6cc\ud06c\ud50c\ub85c\uc6b0-\ub9cc\ub4e4\uae30",level:2},{value:"\ub2e8\uacc41. AWS HealthOmics \ud30c\ub77c\ubbf8\ud130 \ud30c\uc77c",id:"\ub2e8\uacc41-aws-healthomics-\ud30c\ub77c\ubbf8\ud130-\ud30c\uc77c",level:4},{value:"\ub2e8\uacc42. \uc6cc\ud06c\ud50c\ub85c\uc6b0 \uc2a4\ud14c\uc774\uc9d5",id:"\ub2e8\uacc42-\uc6cc\ud06c\ud50c\ub85c\uc6b0-\uc2a4\ud14c\uc774\uc9d5",level:4},{value:"\ub2e8\uacc43. \uc6cc\ud06c\ud50c\ub85c\uc6b0 \uc0dd\uc131 \ud655\uc778",id:"\ub2e8\uacc43-\uc6cc\ud06c\ud50c\ub85c\uc6b0-\uc0dd\uc131-\ud655\uc778",level:4},{value:"\uc6cc\ud06c\ud50c\ub85c\uc6b0 \ud14c\uc2a4\ud2b8\ud558\uae30",id:"\uc6cc\ud06c\ud50c\ub85c\uc6b0-\ud14c\uc2a4\ud2b8\ud558\uae30",level:2},{value:"\uc785\ub825\ud30c\uc77c \uc900\ube44",id:"\uc785\ub825\ud30c\uc77c-\uc900\ube44",level:4},{value:"samplesheet_full",id:"samplesheet_full",level:5},{value:"samplesheet_test",id:"samplesheet_test",level:5},{value:"S3 policy \uad00\ub828 \ucc38\uace0\uc0ac\ud56d",id:"s3-policy-\uad00\ub828-\ucc38\uace0\uc0ac\ud56d",level:5},{value:"Policy \uc900\ube44",id:"policy-\uc900\ube44",level:4},{value:"Prepare IAM service role to run AWS HealthOmics workflow",id:"prepare-iam-service-role-to-run-aws-healthomics-workflow",level:5},{value:"IAM Role \uc0dd\uc131",id:"iam-role-\uc0dd\uc131",level:4},{value:"\uc6cc\ud06c\ud50c\ub85c\uc6b0 \uc2e4\ud589",id:"\uc6cc\ud06c\ud50c\ub85c\uc6b0-\uc2e4\ud589",level:4}];function d(e){const s={a:"a",br:"br",code:"code",h2:"h2",h4:"h4",h5:"h5",img:"img",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.p,{children:["\ucc38\uace0 \ubb38\uc11c: ",(0,t.jsx)(s.a,{href:"https://catalog.us-east-1.prod.workshops.aws/workshops/76d4a4ff-fe6f-436a-a1c2-f7ce44bc5d17/en-US",children:"https://catalog.us-east-1.prod.workshops.aws/workshops/76d4a4ff-fe6f-436a-a1c2-f7ce44bc5d17/en-US"})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.a,{href:"https://catalog.us-east-1.prod.workshops.aws/workshops/76d4a4ff-fe6f-436a-a1c2-f7ce44bc5d17/en-US/introduction/setting-up-environment",children:"\uc774 \ubb38\uc11c\ub97c \ucc38\uace0"}),"\ud558\uc5ec \ud658\uacbd\uc744 \uc900\ube44\ud569\ub2c8\ub2e4. \uc5ec\uae30\uc11c\ub294 \uc774 \uacfc\uc815\uc740 \uc0dd\ub7b5\ud569\ub2c8\ub2e4."]}),"\n",(0,t.jsx)(s.h2,{id:"\ud504\ub85c\uc81d\ud2b8-\uc14b\uc5c5",children:"\ud504\ub85c\uc81d\ud2b8 \uc14b\uc5c5"}),"\n",(0,t.jsx)(s.h4,{id:"nf-core-repository\ub85c\ubd80\ud130-\uc6cc\ud06c\ud50c\ub85c\uc6b0-\ubcf5\uc81c",children:"nf-core repository\ub85c\ubd80\ud130 \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ubcf5\uc81c"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"cd ~\ngit clone https://github.com/nf-core/rnaseq --branch 3.14.0 --single-branch\n"})}),"\n",(0,t.jsx)(s.h4,{id:"docker-image-manifest\uc758-\uc0dd\uc131",children:"Docker Image Manifest\uc758 \uc0dd\uc131"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"cp  ~/amazon-ecr-helper-for-aws-healthomics/lib/lambda/parse-image-uri/public_registry_properties.json namespace.config\n"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"inspect_nf.py"})," \ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"python3 amazon-omics-tutorials/utils/scripts/inspect_nf.py \\\n--output-manifest-file rnaseq_3140_docker_images_manifest.json \\\n -n namespace.config \\\n --output-config-file omics.config \\\n --region  \\\n ~/rnaseq/\n"})}),"\n",(0,t.jsxs)(s.p,{children:["\uc0dd\uc131\ub418\ub294 \ub450 \uac1c\uc758 \ucd9c\ub825\uc740 ",(0,t.jsx)(s.code,{children:"rnaseq_3140_docker_images_manifest.json"})," \uacfc ",(0,t.jsx)(s.code,{children:"omics.config"}),"\uc785\ub2c8\ub2e4."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"rnaseq_3140_docker_images_manifest.json"})," \ud30c\uc77c\uc740 \ub2e4\uc74c\uacfc \uac19\uc740 \ubaa8\uc2b5\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{})}),"\n",(0,t.jsx)(s.p,{children:"\\"}),"\n",(0,t.jsx)(s.h4,{id:"\ucee8\ud14c\uc774\ub108-\uc0ac\uc124\ud654",children:"\ucee8\ud14c\uc774\ub108 \uc0ac\uc124\ud654"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws stepfunctions start-execution \\\n--state-machine-arn arn:aws:states:::stateMachine:omx-container-puller \\\n--input file://rnaseq_3140_docker_images_manifest.json\n"})}),"\n",(0,t.jsx)(s.h4,{id:"nf-core-project-\ucf54\ub4dc-\uc5c5\ub370\uc774\ud2b8",children:"nf-core project \ucf54\ub4dc \uc5c5\ub370\uc774\ud2b8"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"mv omics.config rnaseq/conf\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"echo \"includeConfig 'conf/omics.config'\" >> rnaseq/nextflow.config \n"})}),"\n",(0,t.jsx)(s.h2,{id:""}),"\n",(0,t.jsx)(s.h2,{id:"aws-healthomics-\uc6cc\ud06c\ud50c\ub85c\uc6b0-\ub9cc\ub4e4\uae30",children:"AWS HealthOmics \uc6cc\ud06c\ud50c\ub85c\uc6b0 \ub9cc\ub4e4\uae30"}),"\n",(0,t.jsx)(s.h4,{id:"\ub2e8\uacc41-aws-healthomics-\ud30c\ub77c\ubbf8\ud130-\ud30c\uc77c",children:"\ub2e8\uacc41. AWS HealthOmics \ud30c\ub77c\ubbf8\ud130 \ud30c\uc77c"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"paramter-descrption.json"}),"\uc744 \ub9cc\ub4e4\uc5b4 \uc544\ub798\uc640 \uac19\uc774 \uc800\uc7a5\ud569\ub2c8\ub2e4."]}),"\n",(0,t.jsxs)(s.p,{children:["\uc0c8 \uc6cc\ud06c\ud50c\ub85c\ub9c8\ub2e4 \ub2e4\ub978 \ub9e4\uac1c\ubcc0\uc218\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc704\uc758 \ub9e4\uac1c\ubcc0\uc218 \ud15c\ud50c\ub9bf \ud30c\uc77c\uc740 SCRNA-Seq nf-core \uc6cc\ud06c\ud50c\ub85c\uc5d0\ub9cc \ud574\ub2f9\ub429\ub2c8\ub2e4. \uc0c8 \ud30c\ub77c\ubbf8\ud130 \ud30c\uc77c\uc744 \ub9cc\ub4e4 \ub54c\ub294 \uc774 \uc6cc\ud06c\ud50c\ub85c\uc6b0\uc5d0 \ub300\ud55c \ud30c\ub77c\ubbf8\ud130\ub97c \ud655\uc778\ud574\uc57c \ud569\ub2c8\ub2e4.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.br,{}),"\n","NF-Core \uc6cc\ud06c\ud50c\ub85c\uc6b0\uc5d0 \ub300\ud55c \ud30c\ub77c\ubbf8\ud130\ub97c \ucc3e\uc73c\ub824\uba74 \uc124\uba85\uc11c\ub97c \ucc38\uc870\ud558\uc138\uc694(\uc608: RNA-Seq \ud30c\uc774\ud504\ub77c\uc778 \ud30c\ub77c\ubbf8\ud130\ub294 ",(0,t.jsx)(s.a,{href:"https://nf-co.re/rnaseq/3.14.0/parameters",children:"\uc5ec\uae30"}),").\\"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:',\n    "genome": ,\n    "igenomes_base": ,\n    "fasta": ,\n    "gtf": ,\n    "gff": ,\n    "pseudo_aligner": ,\n    "transcript_fasta": ,\n    "additional_fasta": ,\n    "bbsplit_fasta_list": ,\n    "hisat2_index": ,\n    "salmon_index": ,\n    "rsem_index": ,\n    "skip_bbsplit": ,\n    "pseudo_aligner": ,\n    "umitools_bc_pattern": \n}\n'})}),"\n",(0,t.jsx)(s.h4,{id:"\ub2e8\uacc42-\uc6cc\ud06c\ud50c\ub85c\uc6b0-\uc2a4\ud14c\uc774\uc9d5",children:"\ub2e8\uacc42. \uc6cc\ud06c\ud50c\ub85c\uc6b0 \uc2a4\ud14c\uc774\uc9d5"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"zip -r rnaseq-workflow.zip rnaseq\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws s3 cp rnaseq-workflow.zip s3:///workshop/rnaseq-workflow.zip\n\naws omics create-workflow \\\n  --name rnaseq-v3140 \\\n  --definition-uri s3:////workshop/rnaseq-workflow.zip \\\n  --parameter-template file://parameter-description.json \\\n  --engine NEXTFLOW\n"})}),"\n",(0,t.jsx)(s.h4,{id:"\ub2e8\uacc43-\uc6cc\ud06c\ud50c\ub85c\uc6b0-\uc0dd\uc131-\ud655\uc778",children:"\ub2e8\uacc43. \uc6cc\ud06c\ud50c\ub85c\uc6b0 \uc0dd\uc131 \ud655\uc778"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws omics list-workflows --name rnaseq-v3140\n"})}),"\n",(0,t.jsx)(s.h2,{id:"\uc6cc\ud06c\ud50c\ub85c\uc6b0-\ud14c\uc2a4\ud2b8\ud558\uae30",children:"\uc6cc\ud06c\ud50c\ub85c\uc6b0 \ud14c\uc2a4\ud2b8\ud558\uae30"}),"\n",(0,t.jsx)(s.h4,{id:"\uc785\ub825\ud30c\uc77c-\uc900\ube44",children:"\uc785\ub825\ud30c\uc77c \uc900\ube44"}),"\n",(0,t.jsx)(s.h5,{id:"samplesheet_full",children:"samplesheet_full"}),"\n",(0,t.jsxs)(s.p,{children:["\uc544\ub798\uc758 \uc785\ub825 \ud30c\uc77c\ub4e4\uc740 ",(0,t.jsx)(s.a,{href:"https://github.com/nf-core/rnaseq/blob/master/conf/test_full.config",children:"\uc5ec\uae30"}),"\ub97c \ucc38\uace0\ud558\uc5ec \uc900\ube44\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ub808\ud37c\ub7f0\uc2a4 \ub370\uc774\ud130 \ub2e4\uc6b4\ub85c\ub4dc"})}),"\n",(0,t.jsxs)(s.p,{children:["nf-core/rnaseq repository\uc5d0 \uc788\ub294 ",(0,t.jsx)(s.a,{href:"https://github.com/nf-core/rnaseq/blob/master/conf/igenomes.config",children:(0,t.jsx)(s.code,{children:"igenomes.config"})})," \ub97c \ucc38\uace0\ud558\uc5ec \ud544\uc694\ud55c GRCh37 \ub808\ud37c\ub7f0\uc2a4 \uad00\ub828 \ud30c\uc77c\ub4e4\uc744 \ubaa8\ub450 healthomics\uc758 \uc0ac\uc6a9 \ub9ac\uc804\uc5d0 \ub9cc\ub4e0 \ubc84\ud0b7\uc73c\ub85c \uc900\ube44\ud569\ub2c8\ub2e4.\\"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws s3 sync s3://ngi-igenomes/igenomes/Homo_sapiens/ s3:///workshop/igenomes/Homo_sapiens/\n"})}),"\n",(0,t.jsx)(s.p,{children:"\\"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\uc0d8\ud50c\uc2dc\ud2b8 \uc608\uc81c \ud15c\ud50c\ub9bf \ub2e4\uc6b4\ub85c\ub4dc"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"wget https://raw.githubusercontent.com/nf-core/test-datasets/rnaseq/samplesheet/v3.10/samplesheet_full.csv\n"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"parameter-description.json"}),"\uc5d0 \uc0ac\uc6a9\ub41c \uac83\uacfc \ub3d9\uc77c\ud55c \ud0a4\ub97c \uc0ac\uc6a9\ud558\uc5ec ",(0,t.jsx)(s.code,{children:"input_rnaseq.json"})," \ud30c\uc77c\uc744 \uc0c8\ub85c \ub9cc\ub4ed\ub2c8\ub2e4. \uac12\uc740 \uc6cc\ud06c\ud50c\ub85c\uc5d0\uc11c \ud5c8\uc6a9\ub418\ub294 \uc2e4\uc81c S3 \uacbd\ub85c \ub610\ub294 \ubb38\uc790\uc5f4\uc774 \ub429\ub2c8\ub2e4."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"samplesheet_full.csv"})," \ud30c\uc77c\uc744 \uc0c8\ub85c \uc791\uc131\ud569\ub2c8\ub2e4. \uc774\ub54c HealthOmics\uc640 \uac19\uc740 \ub9ac\uc804\uc5d0 \uc788\ub294 s3 bucket\uc5d0 FASTQ \uc785\ub825\ud30c\uc77c\uc744 \uc900\ube44\ud569\ub2c8\ub2e4. (aws s3 sync \ub098 aws s3 cp \uc640 \uac19\uc740 \uba85\ub839\uc5b4 \ud65c\uc6a9 \uac00\ub2a5)"]}),"\n",(0,t.jsx)(s.p,{children:"\uc608)"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws s3 sync s3://ngi-igenomes/test-data/rnaseq/ s3:///workshop/\n"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"samplesheet_full.csv"})," \uc608\uc2dc"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"sample,fastq_1,fastq_2,strandedness\nGM12878_REP1,s3:///test-data/rnaseq/SRX1603629_T1_1.fastq.gz,s3:///test-data/rnaseq/SRX1603629_T1_2.fastq.gz,reverse\nGM12878_REP2,s3:///test-data/rnaseq/SRX1603630_T1_1.fastq.gz,s3:///test-data/rnaseq/SRX1603630_T1_2.fastq.gz,reverse\nK562_REP1,s3:///test-data/rnaseq/SRX1603392_T1_1.fastq.gz,s3:///test-data/rnaseq/SRX1603392_T1_2.fastq.gz,reverse\nK562_REP2,s3:///test-data/rnaseq/SRX1603393_T1_1.fastq.gz,s3:///test-data/rnaseq/SRX1603393_T1_2.fastq.gz,reverse\nMCF7_REP1,s3:///test-data/rnaseq/SRX2370490_T1_1.fastq.gz,s3:///test-data/rnaseq/SRX2370490_T1_2.fastq.gz,reverse\nMCF7_REP2,s3:///test-data/rnaseq/SRX2370491_T1_1.fastq.gz,s3:///test-data/rnaseq/SRX2370491_T1_2.fastq.gz,reverse\nH1_REP1,s3:///test-data/rnaseq/SRX2370468_T1_1.fastq.gz,s3:///test-data/rnaseq/SRX2370468_T1_2.fastq.gz,reverse\nH1_REP2,s3:///test-data/rnaseq/SRX2370469_T1_1.fastq.gz,s3:///test-data/rnaseq/SRX2370469_T1_2.fastq.gz,revers\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud3b8\uc9d1\ud55c samplesheet \ub97c \ubc84\ud0b7\uc73c\ub85c \ubcf5\uc0ac"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws s3 mv samplesheet_full.csv s3:///workshop/\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"input_rnaseq_full.json"})})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'/workshop/samplesheet_full.csv",\n    "genome": "GRCh37",\n    "igenomes_base": "s3:///workshop/igenomes/",\n    "pseudo_aligner": "salmon"\n}\n'})}),"\n",(0,t.jsx)(s.h5,{id:"samplesheet_test",children:"samplesheet_test"}),"\n",(0,t.jsxs)(s.p,{children:["\uc544\ub798\uc758 \uc785\ub825 \ud30c\uc77c\ub4e4\uc740 ",(0,t.jsx)(s.a,{href:"https://github.com/nf-core/rnaseq/blob/master/conf/test.config",children:"\uc5ec\uae30"}),"\ub97c \ucc38\uace0\ud558\uc5ec \uc900\ube44\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,t.jsx)(s.p,{children:"\uc55e\uc758 samplesheet_full.csv \uc640 \ub2ec\ub9ac \ubcf8 \uc0d8\ud50c\uc2dc\ud2b8 \ub7f0\uc740 \ubbf8\ub2c8 \uc0d8\ud50c\uc774\uae30\ub54c\ubb38\uc5d0 \uad00\ub828 \ub808\ud37c\ub7f0\uc2a4 \ubc0f \ud30c\ub77c\ubbf8\ud130 \uc785\ub825\uc744 \ubaa8\ub450 \uc900\ube44\ud574\uc57c \ud569\ub2c8\ub2e4."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"wget https://raw.githubusercontent.com/nf-core/test-datasets/7f1614baeb0ddf66e60be78c3d9fa55440465ac8/reference/genome.fasta\nwget https://raw.githubusercontent.com/nf-core/test-datasets/7f1614baeb0ddf66e60be78c3d9fa55440465ac8/reference/genes_with_empty_tid.gtf.gz\nwget https://raw.githubusercontent.com/nf-core/test-datasets/7f1614baeb0ddf66e60be78c3d9fa55440465ac8/reference/genes.gff.gz\nwget https://raw.githubusercontent.com/nf-core/test-datasets/7f1614baeb0ddf66e60be78c3d9fa55440465ac8/reference/transcriptome.fasta\nwget https://raw.githubusercontent.com/nf-core/test-datasets/7f1614baeb0ddf66e60be78c3d9fa55440465ac8/reference/gfp.fa.gz\nwget https://raw.githubusercontent.com/nf-core/test-datasets/7f1614baeb0ddf66e60be78c3d9fa55440465ac8/reference/bbsplit_fasta_list.txt\nwget https://raw.githubusercontent.com/nf-core/test-datasets/7f1614baeb0ddf66e60be78c3d9fa55440465ac8/reference/hisat2.tar.gz\nwget https://raw.githubusercontent.com/nf-core/test-datasets/7f1614baeb0ddf66e60be78c3d9fa55440465ac8/reference/salmon.tar.gz\nwget https://raw.githubusercontent.com/nf-core/test-datasets/7f1614baeb0ddf66e60be78c3d9fa55440465ac8/reference/rsem.tar.gz\n"})}),"\n",(0,t.jsx)(s.p,{children:"\ub2e4\uc6b4\ub85c\ub4dc \ubc1b\uc740 \ud30c\uc77c\ub4e4\uc744 s3 bucket \uc73c\ub85c \uc5c5\ub85c\ub4dc"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws s3 sync . s3:///workshop/reference/\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\uc0d8\ud50c\uc2dc\ud2b8 \uc608\uc81c \ud15c\ud50c\ub9bf \ub2e4\uc6b4\ub85c\ub4dc"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"wget https://raw.githubusercontent.com/nf-core/test-datasets/rnaseq/samplesheet/v3.10/samplesheet_test.csv\n"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"samplesheet_test.csv"})," \uc608\uc2dc"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"sample,fastq_1,fastq_2,strandedness\nWT_REP1,s3:///workshop/test_fastq/SRR6357070_1.fastq.gz,s3:///workshop/test_fastq/SRR6357070_2.fastq.gz,auto\nWT_REP1,s3:///workshop/test_fastq/SRR6357071_1.fastq.gz,s3:///workshop/test_fastq/SRR6357071_2.fastq.gz,auto\nWT_REP2,s3:///workshop/test_fastq/SRR6357072_1.fastq.gz,s3:///workshop/test_fastq/SRR6357072_2.fastq.gz,reverse\nRAP1_UNINDUCED_REP1,s3:///workshop/test_fastq/SRR6357073_1.fastq.gz,,reverse\nRAP1_UNINDUCED_REP2,s3:///workshop/test_fastq/SRR6357074_1.fastq.gz,,reverse\nRAP1_UNINDUCED_REP2,s3:///workshop/test_fastq/SRR6357075_1.fastq.gz,,reverse\nRAP1_IAA_30M_REP1,s3:///workshop/test_fastq/SRR6357076_1.fastq.gz,s3:///workshop/test_fastq/SRR6357076_2.fastq.gz,reverse\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud3b8\uc9d1\ud55c samplesheet \ub97c \ubc84\ud0b7\uc73c\ub85c \ubcf5\uc0ac"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws s3 mv samplesheet_test.csv s3:///workshop/\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.code,{children:"input_rnaseq_test.json"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'/workshop/samplesheet_test.csv",\n    "fasta": "s3:///workshop/reference/genome.fasta",\n    "gtf": "s3:///workshop/reference/genes_with_empty_tid.gtf.gz",\n    "gff": "s3:///workshop/reference/genes.gff.gz",\n    "transcript_fasta": "s3:///workshop/reference/transcriptome.fasta",\n    "additional_fasta": "s3:///workshop/reference/gfp.fa.gz",\n    "bbsplit_fasta_list": "s3:///workshop/reference/bbsplit_fasta_list.txt",\n    "hisat2_index": "s3:///workshop/reference/hisat2.tar.gz",\n    "salmon_index": "s3:///workshop/reference/salmon.tar.gz",\n    "rsem_index": "s3:///workshop/reference/rsem.tar.gz",\n    "skip_bbsplit"        : false,\n    "pseudo_aligner"      : "salmon",\n    "umitools_bc_pattern" : "NNNN"\n}\n'})}),"\n",(0,t.jsx)(s.p,{children:"\uc0c1\uae30 bbsplit_fasta_list.txt \ud30c\uc77c \ub0b4\uc6a9\ub3c4 s3 bucket\uc744 \uc9c0\uc815\ud569\ub2c8\ub2e4."}),"\n",(0,t.jsx)(s.p,{children:"s3:///workshop/reference/bbsplit_fasta_list.txt \uc758 \ub0b4\uc6a9\\"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"sarscov2,s3:///workshop/reference/GCA_009858895.3_ASM985889v3_genomic.200409.fna\nhuman,s3:///workshop/reference/chr22_23800000-23980000.fa\n"})}),"\n",(0,t.jsx)(s.h5,{id:"s3-policy-\uad00\ub828-\ucc38\uace0\uc0ac\ud56d",children:"S3 policy \uad00\ub828 \ucc38\uace0\uc0ac\ud56d"}),"\n",(0,t.jsxs)(s.p,{children:["\uc704\uc758 \uc785\ub825\ub370\uc774\ud130\ub85c \ud544\uc694\ud55c S3 \ubc84\ud0b7\uc5d0 \ub300\ud574 \uc544\ub798 Policy \uc900\ube44\uc5d0 \ubc18\uc601\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4.",(0,t.jsx)(s.br,{}),"\n","\ub9c8\ucc2c\uac00\uc9c0\ub85c \uacb0\uacfc \ub370\uc774\ud130\ub97c \uc791\uc131\ud560 \ubc84\ud0b7\uc5d0 \ub300\ud55c \uad8c\ud55c\ub3c4 Policy \uc900\ube44\uc5d0 \ubc18\uc601\ud574\uc8fc\uc138\uc694.\\"]}),"\n",(0,t.jsxs)(s.p,{children:["s3",":GetObject",", s3",":ListBucket"," \uad8c\ud55c"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"\uc774\ubbf8\uc9c0",src:n(5636).A+"",width:"2406",height:"314"})}),"\n",(0,t.jsxs)(s.p,{children:["s3",":PutObject"," \uad8c\ud55c"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"\uc774\ubbf8\uc9c0",src:n(6539).A+"",width:"1154",height:"392"})}),"\n",(0,t.jsx)(s.h4,{id:"policy-\uc900\ube44",children:"Policy \uc900\ube44"}),"\n",(0,t.jsx)(s.h5,{id:"prepare-iam-service-role-to-run-aws-healthomics-workflow",children:"Prepare IAM service role to run AWS HealthOmics workflow"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"omics_workflow_policy.json"})," \ub9cc\ub4e4\uae30"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'# \ud658\uacbd \ubcc0\uc218 \uc124\uc815\nExport yourbucket="your-bucket-name"\nExport your_account_id="your-account-id"\nExport region="your-region"\n\n# JSON \ub0b4\uc6a9 \uc0dd\uc131 \ubc0f \ud30c\uc77c\ub85c \uc800\uc7a5\ncat  omics_workflow_policy.json\n/*"\n            ]\n        },\n        "\n            ]\n        },\n        /*"\n            ]\n        },\n        :$:log-group:/aws/omics/WorkflowLog:log-stream:*"\n            ]\n        },\n        :$:log-group:/aws/omics/WorkflowLog:*"\n            ]\n        },\n        :$:repository/*"\n            ]\n        }\n    ]\n}\nEOF\n\necho "omics_workflow_policy.json \ud30c\uc77c\uc774 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4."\n'})}),"\n",(0,t.jsx)(s.p,{children:"trust_policy.json \ub9cc\ub4e4\uae30"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'# \ud658\uacbd \ubcc0\uc218 \uc124\uc815\nExport your_account_id="your-account-id"\nExport region="your-region"  # \uc608: us-east-1\n\n# JSON \ub0b4\uc6a9 \uc0dd\uc131 \ubc0f \ud30c\uc77c\ub85c \uc800\uc7a5\ncat  trust_policy.json\n,\n            "Action": "sts:AssumeRole",\n            "Condition": "\n                },\n                "ArnLike": :$:run/*"\n                }\n            }\n        }\n    ]\n}\nEOF\n\necho "trust_policy.json \ud30c\uc77c\uc774 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4."\n'})}),"\n",(0,t.jsx)(s.h4,{id:"iam-role-\uc0dd\uc131",children:"IAM Role \uc0dd\uc131"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws iam create-role --role-name omics_start_run_role_v1 --assume-role-policy-document file://trust_policy.json\n"})}),"\n",(0,t.jsx)(s.p,{children:"Policy document \uc0dd\uc131"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws iam put-role-policy --role-name omics_start_run_role_v1 --policy-name OmicsWorkflowV1 --policy-document file://omics_workflow_policy.json\n"})}),"\n",(0,t.jsx)(s.h4,{id:"\uc6cc\ud06c\ud50c\ub85c\uc6b0-\uc2e4\ud589",children:"\uc6cc\ud06c\ud50c\ub85c\uc6b0 \uc2e4\ud589"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"--storage-type"})," \ud30c\ub77c\ubbf8\ud130\ub97c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc73c\uba74 \uae30\ubcf8\uac12\uc740 STATIC \uc785\ub2c8\ub2e4. (",(0,t.jsx)(s.a,{href:"https://awscli.amazonaws.com/v2/documentation/api/latest/reference/omics/start-run.html",children:"\ucc38\uace0"}),")\xa0\\"]}),"\n",(0,t.jsx)(s.p,{children:"\ub3d9\uc801 \uc2e4\ud589 \uc2a4\ud1a0\ub9ac\uc9c0 (DYNAMIC)\ub294 \uc815\uc801 \uc2e4\ud589 \uc2a4\ud1a0\ub9ac\uc9c0 (STATIC) \ubcf4\ub2e4 \ud504\ub85c\ube44\uc800\ub2dd/\ub514\ud504\ub85c\ube44\uc800\ub2dd \uc2dc\uac04\uc774 \ub354 \ube60\ub985\ub2c8\ub2e4. \ube60\ub978 \uc124\uc815\uc740 \uc790\uc8fc \uc2e4\ud589\ub418\ub294 \uc18c\uaddc\ubaa8 \uc6cc\ud06c\ud50c\ub85c\uc6b0\uc5d0 \uc720\ub9ac\ud558\uba70 \uac1c\ubc1c/\ud14c\uc2a4\ud2b8 \uc8fc\uae30 \ub3d9\uc548\uc5d0\ub3c4 \uc774\uc810\uc774 \uc788\uc2b5\ub2c8\ub2e4. \ub530\ub77c\uc11c \ucc98\uc74c\uc5d0 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud558\uba74\uc11c \ud14c\uc2a4\ud2b8\ud560 \uacbd\uc6b0 \uc774 \uc635\uc158\uc744 DYNAMIC\uc73c\ub85c \uc124\uc815\ud55c \ub4a4 \uc2a4\ud1a0\ub9ac\uc9c0 \uc0ac\uc6a9\ub7c9\uc5d0 \ub530\ub77c STATIC\uc73c\ub85c \uc124\uc815 \ud558\ub294 \uac83\uc744 \ucd94\ucc9c\ub4dc\ub9bd\ub2c8\ub2e4.\\"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws omics start-run \\\n  --name rnaseq_workshop_run_1 \\\n  --role-arn arn:aws:iam:::role/omics_start_run_role_v1 \\\n  --workflow-id  \\\n  --parameters file://input_rnaseq.json \\\n  --output-uri s3:///output/ \\\n  --storage-type \xa0DYNAMIC\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws omics start-run \\\n  --name rnaseq_workshop_run_1 \\\n  --role-arn arn:aws:iam:::role/omics_start_run_role_v1 \\\n  --workflow-id  \\\n  --parameters file://input_rnaseq.json \\\n  --output-uri s3:///output/\n  --storage-type STATIC \\\n  --storage-capacity 2048\n"})}),"\n",(0,t.jsx)(s.p,{children:"test \uc0d8\ud50c\ub85c \ud560 \uacbd\uc6b0 \uc608\uc2dc"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"aws omics start-run \\\n  --name rnaseq_workshop_test_run_1 \\\n  --role-arn arn:aws:iam:::role/omics_start_run_role_v1 \\\n  --workflow-id  \\\n  --parameters file://input_rnaseq_test.json \\\n  --output-uri s3:///output/\n"})}),"\n",(0,t.jsx)(s.p,{children:"\ucc38\uace0\ubb38\uc11c"}),"\n",(0,t.jsxs)(s.p,{children:["- ",(0,t.jsx)(s.a,{href:"https://github.com/aws-samples/amazon-omics-tutorials/tree/main/example-workflows/nf-core/workflows/rnaseq",children:"https://github.com/aws-samples/amazon-omics-tutorials/tree/main/example-workflows/nf-core/workflows/rnaseq"})]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},5636(e,s,n){n.d(s,{A:()=>r});const r=n.p+"assets/images/image-3e85724a564dc17aa0100397b901dbbf.png"},6539(e,s,n){n.d(s,{A:()=>r});const r=n.p+"assets/images/eA3image-2876447a53ab3e9067f4bfeadeb2cb5a.png"},8453(e,s,n){n.d(s,{R:()=>a,x:()=>c});var r=n(6540);const t={},o=r.createContext(t);function a(e){const s=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(o.Provider,{value:s},e.children)}}}]);